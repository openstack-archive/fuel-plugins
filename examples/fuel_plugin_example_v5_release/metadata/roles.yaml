controller:
  name: "Controller"
  description: "The Controller initiates orchestration activities and provides an external API.  Other components like Glance (image storage), Keystone (identity management), Horizon (OpenStack dashboard) and Nova-Scheduler are installed on the controller as well."
  weight: 10
  conflicts:
    - compute
    - ceph-osd
  update_required:
    - compute
    - cinder
  has_primary: true
  public_ip_required: true
  public_for_dvr_required: true
  group: "base"
  limits:
    min: 1
    recommended: 3
    overrides:
      - condition: "settings:neutron_advanced_configuration.neutron_l3_ha.value == true"
        min: 2
        message: "Neutron L3 HA requires at least 2 Controller nodes to function properly."
compute:
  name: "Compute"
  description: "A Compute node creates, manages, and terminates virtual machine instances."
  weight: 20
  public_for_dvr_required: true
  group: "compute"
  limits:
    recommended: 1
  fault_tolerance: "2%"
cinder:
  # NOTE: naming, see https://bugs.launchpad.net/fuel/+bug/1383224
  name: "Cinder"
  description: "Cinder provides scheduling of block storage resources, typically delivered over iSCSI and other compatible backend storage systems. Block storage can be used for database storage, expandable file systems, or to provide a server with access to raw block level devices."
  weight: 30
  group: "storage"
  limits:
    recommended: 1
  restrictions:
    - condition: "settings:storage.volumes_lvm.value == false"
      message: "Cinder LVM should be enabled in the environment settings."
    # NOTE: https://bugs.launchpad.net/fuel/+bug/1372914 - Prohibit possibility of adding cinder nodes to an environment with Ceph RBD
    - condition: "settings:storage.volumes_ceph.value == true"
      message: "Ceph RBD cannot be used with Cinder"
cinder-block-device:
  name: 'Cinder Block Device'
  description: 'Host node for Cinder Block Devices.'
  has_primary: false
  public_ip_required: false
  weight: 35
  group: "storage"
  conflicts:
    - controller
    - cinder
    - cinder-vmware
    - ceph-osd
  restrictions:
    - condition: "settings:storage.volumes_block_device.value == false"
      message: "Cinder Block Device driver should be enabled in the environment settings."
    - condition: "settings:storage.volumes_ceph.value == true"
      message: "Ceph RBD cannot be used with Cinder Block Device"
cinder-vmware:
  name: "Cinder Proxy to VMware Datastore"
  description: "Cinder-VMware provides scheduling of block storage resources delivered over VMware vCenter. Block storage can be used for database storage, expandable file systems, or providing a server with access to raw block level devices."
  weight: 40
  group: "storage"
  limits:
    recommended: 1
  restrictions:
    - condition: "settings:common.use_vcenter.value == false"
      action: "hide"
      message: "VMware vCenter not enabled for cluster"
ceph-osd:
  name: "Ceph OSD"
  description: "Ceph storage can be configured to provide storage for block volumes (Cinder), images (Glance) and ephemeral instance storage (Nova). It can also provide object storage through the S3 and Swift API (See settings to enable each)."
  weight: 50
  group: "storage"
  limits:
      min: "settings:storage.osd_pool_size.value"
  restrictions:
    - condition: "settings:storage.volumes_ceph.value == false and settings:storage.images_ceph.value == false and settings:storage.ephemeral_ceph.value == false and settings:storage.objects_ceph.value == false"
      message: "Ceph should be enabled in the environment settings."
  update_once:
    - controller
mongo:
  name: "Telemetry - MongoDB"
  description: "A feature-complete and recommended database for storage of metering data from OpenStack Telemetry (Ceilometer)."
  weight: 60
  group: "other"
  conflicts:
    - compute
    - ceph-osd
  has_primary: true
  limits:
    min: 1
    overrides:
      - condition: "cluster:mode != 'ha_compact'"
        max: 1
        message: "At most 1 MongoDB node can be added for non-HA deployment"
      - condition: "cluster:mode == 'ha_compact'"
        recommended: 3
        message: "At least 3 MongoDB nodes are recommended for HA deployment."
  restrictions:
    - condition: "settings:additional_components.ceilometer.value == false"
      message: "Ceilometer should be enabled in the environment settings."
    - condition: "settings:additional_components.mongo.value == true"
      message: "You are already using external MongoDB."
base-os:
  name: "Operating System"
  description: "Install base Operating System without additional packages and configuration."
  weight: 70
  group: "other"
virt:
  name: "Virtual"
  description: "ADVANCED: Make available possibilities to spawn vms on this node that can be assign as a normal nodes."
  weight: 80
  group: "compute"
  public_ip_required: true
  conflicts:
    - controller
    - base-os
  restrictions:
    - condition: "not ('advanced' in version:feature_groups)"
      action: "hide"
      message: "Advanced feature should be enabled in feature groups"
compute-vmware:
  name: "Compute VMware"
  description: "A node that runs nova-compute with VCDriver, that manages ESXi computing resources via VMware vCenter."
  weight: 90
  group: "compute"
  conflicts:
    - controller
    - compute
    - cinder
    - cinder-block-device
    - ceph-osd
    - mongo
    - base-os
    - virt
    - ironic
  restrictions:
    - condition: "settings:common.use_vcenter.value == false"
      action: "hide"
      message: "VMware vCenter not enabled for cluster"
ironic:
  name: "Ironic"
  description: "Ironic conductor."
  weight: 100
  group: "compute"
  limits:
    min: 1
    recommended: 3
  conflicts:
    - compute
  restrictions:
    - condition: "settings:additional_components.ironic.value == false"
      message: "Ironic should be enabled in the environment settings."